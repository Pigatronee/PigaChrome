<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Electron Browser with Tabs Explained</title>
<style>
  body { font-family: Arial, sans-serif; line-height: 1.6; margin: 20px; }
  h1, h2 { color: #333; }
  pre { background: #f4f4f4; padding: 10px; border-radius: 5px; overflow-x: auto; }
  code { color: #c7254e; background: #f9f2f4; padding: 2px 4px; border-radius: 3px; }
  .note { background: #e7f3fe; padding: 10px; border-left: 4px solid #2196F3; margin: 10px 0; }
</style>
</head>
<body>

<h1>Electron Browser with Tabs: Explanation</h1>

<h2>1. Base Window Setup</h2>
<p>Your code begins by creating a <code>BrowserWindow</code> with a preload script and no Node integration in the renderer:</p>
<pre><code>win = new BrowserWindow({
    width: 1000,
    height: 700,
    webPreferences: {
        nodeIntegration: false,
        contextIsolation: true,
        preload: __dirname + "/preload.js",
        sandbox: true
    }
});</code></pre>
<p>This ensures the renderer (your HTML) is isolated and safe, while still allowing communication through the preload script.</p>

---

<h2>2. BrowserView Creation</h2>
<p>A <code>BrowserView</code> is created to display websites:</p>
<pre><code>view = new BrowserView();
win.setBrowserView(view);</code></pre>
<p>Unlike an <code>&lt;iframe&gt;</code>, a <code>BrowserView</code> is a full Chromium view, so sites like Google will render correctly.</p>

---

<h2>3. Toolbar Height & Layout</h2>
<p>The top 50 pixels are reserved for your toolbar:</p>
<pre><code>const TOOLBAR_HEIGHT = 50;</code></pre>
<p>Then the BrowserView is sized to fit below the toolbar:</p>
<pre><code>view.setBounds({
    x: 0,
    y: TOOLBAR_HEIGHT,
    width: bounds.width,
    height: bounds.height - TOOLBAR_HEIGHT
});</code></pre>

---

<h2>4. Resizing</h2>
<p>When the window resizes, the BrowserView must be updated too:</p>
<pre><code>win.on("resize", () =&gt; {
    const bounds = win.getBounds();
    view.setBounds({
        x: 0,
        y: TOOLBAR_HEIGHT,
        width: bounds.width,
        height: bounds.height - TOOLBAR_HEIGHT
    });
});</code></pre>
<p>This ensures the web content always fills the space below the toolbar.</p>

---

<h2>5. Search IPC</h2>
<p>The renderer (your HTML with search box) sends a query via IPC:</p>
<pre><code>ipcMain.on("search", (event, query) =&gt; {
    if (!query) return;
    const url = "https://www.google.com/search?q=" + encodeURIComponent(query);
    view.webContents.loadURL(url);
});</code></pre>
<p>When you type in the search bar and hit Enter, the BrowserView loads the search results.</p>

---

<h2>6. Preparing for Tabs</h2>
<p>Right now, you only track <code>view</code>. To add tabs, we need an array of tab objects:</p>
<pre><code>let tabs = [];
let currentTab = null;
</code></pre>

<p>Each tab would look like this:</p>
<pre><code>{
  id: 1,
  view: BrowserView instance,
  url: "https://google.com",
  title: "Google"
}
</code></pre>

---

<h2>7. Creating a New Tab</h2>
<p>Instead of one <code>view</code>, create a function:</p>
<pre><code>function createTab(url = "https://www.google.com") {
    const newView = new BrowserView();
    win.setBrowserView(newView);

    const bounds = win.getBounds();
    newView.setBounds({
        x: 0,
        y: TOOLBAR_HEIGHT,
        width: bounds.width,
        height: bounds.height - TOOLBAR_HEIGHT
    });

    newView.webContents.loadURL(url);

    const tab = { id: Date.now(), view: newView, url, title: "New Tab" };
    tabs.push(tab);
    switchTab(tab.id);
}
</code></pre>

---

<h2>8. Switching Tabs</h2>
<p>To switch, remove the current BrowserView and show another:</p>
<pre><code>function switchTab(id) {
    const tab = tabs.find(t =&gt; t.id === id);
    if (!tab) return;

    if (currentTab) {
        win.removeBrowserView(currentTab.view);
    }

    win.setBrowserView(tab.view);
    const bounds = win.getBounds();
    tab.view.setBounds({
        x: 0,
        y: TOOLBAR_HEIGHT,
        width: bounds.width,
        height: bounds.height - TOOLBAR_HEIGHT
    });

    currentTab = tab;
}
</code></pre>

---

<h2>9. Closing Tabs</h2>
<p>When a tab is closed:</p>
<pre><code>function closeTab(id) {
    const idx = tabs.findIndex(t =&gt; t.id === id);
    if (idx === -1) return;

    const tab = tabs[idx];
    win.removeBrowserView(tab.view);
    tab.view.destroy();
    tabs.splice(idx, 1);

    if (tabs.length &gt; 0) {
        switchTab(tabs[0].id);
    } else {
        currentTab = null;
    }
}
</code></pre>

---

<h2>10. Summary</h2>
<ul>
  <li><code>BrowserView</code> replaces iframes for embedding websites.</li>
  <li>Reserve toolbar height with <code>y: TOOLBAR_HEIGHT</code>.</li>
  <li>Use <code>win.on("resize")</code> to make the BrowserView responsive.</li>
  <li>Tabs = an array of { id, view, url, title } objects.</li>
  <li>Switch tabs by swapping BrowserViews in and out of the window.</li>
</ul>

<div class="note">
With this structure, you can now evolve from a single-view “mini browser” into a multi-tab system.
</div>

</body>
</html>
